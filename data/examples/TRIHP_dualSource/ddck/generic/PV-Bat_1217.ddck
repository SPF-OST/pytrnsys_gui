VERSION 18
*******************************************************************************
*** TRNSYS input file (deck) generated by TrnsysStudio
*** on lunes, septiembre 13, 2021 at 23:15
*** from TrnsysStudio project: C:\Z0000_IREC\temp\TRI-HP\bateria\TRNSYS_PROJECT\PV-Bat_EMS.tpf
*** 
*** If you edit this file, use the File/Import TRNSYS Input File function in 
*** TrnsysStudio to update the project. 
*** 
*** If you have problems, questions or suggestions please contact your local 
*** TRNSYS distributor or mailto:software@cstb.fr 
*** 
*******************************************************************************


*******************************************************************************
*** Units 
*******************************************************************************

*******************************************************************************
*** Control cards
*******************************************************************************
* START, STOP and STEP
CONSTANTS 3
START=0
STOP=24
STEP=1/60
SIMULATION 	 START	 STOP	 STEP	! Start time	End time	Time step
TOLERANCES 0.001 0.001			! Integration	 Convergence
LIMITS 30 30 30				! Max iterations	Max warnings	Trace limit
DFQ 1					! TRNSYS numerical integration solver method
WIDTH 80				! TRNSYS output file width, number of characters
LIST 					! NOLIST statement
					! MAP statement
SOLVER 0 1 1				! Solver statement	Minimum relaxation factor	Maximum relaxation factor
NAN_CHECK 1				! Nan DEBUG statement
OVERWRITE_CHECK 1			! Overwrite DEBUG statement
TIME_REPORT 1			! enable time report statement
EQSOLVER 0				! EQUATION SOLVER statement
* User defined CONSTANTS 
*$USER_CONSTANTS
EQUATIONS 1
nPlots =  (STOP-START)/168.

CONSTANTS 3
Area = 0.89
N_series = 5
N_parallel = 1



*$USER_CONSTANTS_END


* Model "PV" (Type 14)
* 

UNIT 2 TYPE 14	 PV
*$UNIT_NAME PV
*$MODEL .\Utility\Forcing Functions\General\Type14h.tmf
*$POSITION 102 261
*$LAYER Main # 
PARAMETERS 10
0		! 1 Initial value of time
0		! 2 Initial value of function
8		! 3 Time at point
0		! 4 Value at point
16		! 5 Time at point
5		! 6 Value at point
20		! 7 Time at point
0		! 8 Value at point
24		! 9 Time at point
0		! 10 Value at point
*------------------------------------------------------------------------------

* Model "HH" (Type 14)
* 

UNIT 3 TYPE 14	 HH
*$UNIT_NAME HH
*$MODEL .\Utility\Forcing Functions\General\Type14h.tmf
*$POSITION 102 407
*$LAYER Main # 
PARAMETERS 12
0		! 1 Initial value of time
0.5		! 2 Initial value of function
6		! 3 Time at point
0.5		! 4 Value at point
10		! 5 Time at point
4		! 6 Value at point
15		! 7 Time at point
1.5		! 8 Value at point
20		! 9 Time at point
6		! 10 Value at point
24		! 11 Time at point
0.5		! 12 Value at point
*------------------------------------------------------------------------------

* Model "Sys" (Type 14)
* 

UNIT 4 TYPE 14	 Sys
*$UNIT_NAME Sys
*$MODEL .\Utility\Forcing Functions\General\Type14h.tmf
*$POSITION 102 554
*$LAYER Main # 
PARAMETERS 14
0		! 1 Initial value of time
0.5		! 2 Initial value of function
6		! 3 Time at point
0.9		! 4 Value at point
9		! 5 Time at point
3		! 6 Value at point
11		! 7 Time at point
1.5		! 8 Value at point
20		! 9 Time at point
2		! 10 Value at point
23		! 11 Time at point
3		! 12 Value at point
24		! 13 Time at point
0.5		! 14 Value at point
*------------------------------------------------------------------------------


EQUATIONS 3    ! Stromverbrauch und Stromnetzbilanz THIS WILL BE ELIMINATED           ! System electricity consumption [kW]
PelPVAC_kW = [2,1]
PelHH_kW = [3,1]
PelHeatSys_kW = [4,1]

EQUATIONS 1
PelUsedTotal_kW = PelHeatSys_kW + PelHH_kW + PelBatStandby_kW    !kW, Total konsumierter Strom des GebÃ¤udes [kW]


**********************************
** Generic constants
**********************************

CONSTANTS 3 !Needed to run but no need here
PelFuelCell_kW = 0
PelFuelCellToBat_kW = 0
PelFuelCellToBui_kW = 0

CONSTANTS 12   ! PARAMETERS FOR TYPE1217
mode = 2				! (1)-NoBat-Autoconsum (2)-Bat-Autoconsum (3)-Bat-Setpoints
minElBatFactor = 0.02
CapBatMax_kWh = 20.0    		!kWh, Maximale Batteriekapazität zur Zeit 0 [kWh]
maxBatteryPower_kW = 10.0 		!CapBatMaxT0_kWh * 12./50.    !kW, Maximum battery charging power [kW]
MinPelFromToBat_kW = minElBatFactor*CapBatMax_kWh    !kW, Minimum delivered power from the battery
SOCBeginBat = 0.3
FrBatSOCmin = 0.10    !0-1, Minimaler Ladeanteil der Batterie
FrBatSOCmax = 0.90    !0-1, Minimaler Ladeanteil der Batterie
PelBatStandby_kW = 0.005    !kW, Standbyverluste + Reglerverbrauch Batterie
inverterEffDCAC = 0.9
effBatDischarge = 0.9
effBatCharge = 0.9








*-------------------- OUTPUTS--------------------------------------------------

* Model "Type65c" (Type 65)
* 

UNIT 8 TYPE 65	 Type65c
*$UNIT_NAME Type65c
*$MODEL .\Output\Online Plotter\Online Plotter With File\No Units\Type65c.tmf
*$POSITION 956 261
*$LAYER Main # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
-10.0		! 3 Left axis minimum
10.0		! 4 Left axis maximum
-10.0		! 5 Right axis minimum
10.0		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
30		! 10 Logical Unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
2,1 				! PV:Average value of function ->Left axis variable-1
3,1 				! HH:Average value of function ->Left axis variable-2
4,1 				! Sys:Average value of function ->Left axis variable-3
5,9				!	PelPVDC_kW			! kW	PV Production DC - 
5,10				!	PelPVAC_kW			! kW	PV Production AC -
5,11				!	PelUsedTotal_kW		! kW	Total Power consumed (HH + HeatSys + BatStandby)
5,12				!	PvUsed_kW 			! kW	PV production instantly consumed
5,13				!	PelGrid_kW			! kW	Power delivered(+)/Exported(-) from/to the grid
5,14				!	PelGrid_del			! kW	Power delivered from the grid -  (PelFromGrid_kW/ElSysIn_Grid in PyTRNSYS)
5,15				!	PelGrid_exp			! kW	Power evxported to the grid	- 	 (PvToGrid_kW/elSysOut_PvToGrid in PYTRNSYS)
5,1				! 0-1 	SOC (State of Charge) of the battery at the end of the time step
5,2				!	SOCBat_kWh			! kWh 	State of the capacity of the battery
5,3				!	PelBatDC_kW 		! kW	Power charging(+);discharging(-) the battery
5,4				!	PelBatStandby_kW 	! kW	Standby power consumption of the battery
5,5				!   PelBatLoss_kW 		! kW	Power loosses of the battery -	(elSysOut_BatLoss in PyTRNSYS)
5,6				!	PelLossesDCAC 		! kW	Power loosses in the inverter - (elSysOut_InvLoss in PyTRNSYS)
5,16				!ACimb				! 0-1	Flag indicating an error in the AC energy balance (Error=1)
5,17				!DCimb				! 0-1	Flag indicating an error in the DC energy balance (Error=1)
5,18				!Totimb				! 0-1	Flag indicating an error in the Total energy balance (Error=1)
5,19				! 0-1	Flag indicating if battery is charging(1) or discharging(0)		
*** INITIAL INPUT VALUES
PV HH Heat_Sys PVDC PVAC PusedTOT PVUsed PelGrid PGrid_del PGrid_exp SOC SOC_kwh PelBat PelStndby PelBatloss PelInvLoss ACimb DCImb Totimb BoLoadBat
LABELS  3
"kW"
"-"
"Graph 1"
*** External files
ASSIGN "***.plt" 30
*|? What file should the online print to? |1000
*------------------------------------------------------------------------------

END
*!LINK_STYLE
*!LINK 7:8
*!CONNECTION_SET 40:40:0:0:5:0:0:0:1:232,98:252,98:252,232:939,232
*!LINK 6:8
*!CONNECTION_SET 40:20:0:0:4:0:0:0:1:486,79:901,79:901,232:939,232
*!LINK 4:8
*!CONNECTION_SET 37:20:0:40:3:0:0:0:1:122,545:901,545:901,272:939,272
*!LINK 3:8
*!CONNECTION_SET 37:20:0:40:2:0:0:0:1:122,398:901,398:901,272:939,272
*!LINK 2:8
*!CONNECTION_SET 37:20:0:20:1:0:0:0:1:122,252:901,252:939,252
*!LINK 4:6
*!CONNECTION_SET 37:20:0:20:4:0:0:0:1:122,545:418,545:418,79:446,79
*!LINK 3:6
*!CONNECTION_SET 37:20:0:20:3:0:0:0:1:122,398:418,398:418,79:446,79
*!LINK 2:6
*!CONNECTION_SET 37:20:0:20:2:0:0:0:1:122,252:418,252:418,79:446,79
*!LINK 7:6
*!CONNECTION_SET 40:20:0:20:1:0:0:0:1:232,78:418,78:418,79:446,79
*!LINK_STYLE_END
